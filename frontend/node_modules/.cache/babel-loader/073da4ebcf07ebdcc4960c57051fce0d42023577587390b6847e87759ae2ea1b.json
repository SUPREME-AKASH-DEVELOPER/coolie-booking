{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import io from\"socket.io-client\";import axios from\"axios\";import\"./App.css\";// Ensure you have this CSS file\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io(\"https://coolie-booking-service.onrender.com\");const App=()=>{const[bookings,setBookings]=useState([]);const[form,setForm]=useState({passengerName:\"\",trainNumber:\"\",coachNumber:\"\",station:\"\",minutesBeforeArrival:\"\",cooliesNeeded:\"\"});useEffect(()=>{fetchBookings();socket.on(\"updateBookings\",newBooking=>{setBookings(prev=>[...prev,newBooking]);});return()=>socket.off(\"updateBookings\");},[]);const fetchBookings=async()=>{const res=await axios.get(\"https://coolie-booking-service.onrender.com/api/bookings\");setBookings(res.data);};const handleChange=e=>{setForm({...form,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();const res=await axios.post(\"https://coolie-booking-service.onrender.com/api/bookings\",form);socket.emit(\"newBooking\",res.data);setForm({passengerName:\"\",trainNumber:\"\",coachNumber:\"\",station:\"\",minutesBeforeArrival:\"\",cooliesNeeded:\"\"});fetchBookings();};// Clear All Active Bookings Manually\nconst clearBookings=async()=>{await axios.delete(\"https://coolie-booking-service.onrender.com/api/bookings/clear\");setBookings([]);alert(\"All active bookings cleared!\");};// Auto-delete bookings +10 mins after \"Minutes Before Arrival\"\nuseEffect(()=>{const interval=setInterval(()=>{const now=new Date();const updatedBookings=bookings.filter(b=>{const arrivalTime=new Date(b.createdAt);arrivalTime.setMinutes(arrivalTime.getMinutes()+b.minutesBeforeArrival+10);return arrivalTime>now;});setBookings(updatedBookings);},60000);// Runs every 60 seconds\nreturn()=>clearInterval(interval);},[bookings]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking-form\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDE86 Coolie Booking Service\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"passengerName\",placeholder:\"Passenger Name\",value:form.passengerName,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"trainNumber\",placeholder:\"Train Number\",value:form.trainNumber,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"coachNumber\",placeholder:\"Coach Number\",value:form.coachNumber,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"station\",placeholder:\"Station Name\",value:form.station,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"minutesBeforeArrival\",placeholder:\"Minutes Before Arrival\",value:form.minutesBeforeArrival,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"cooliesNeeded\",placeholder:\"Coolies Needed\",value:form.cooliesNeeded,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Book Coolie \\uD83D\\uDE80\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"active-bookings\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCCB Active Bookings:\"}),/*#__PURE__*/_jsx(\"button\",{onClick:clearBookings,style:{background:\"red\",color:\"white\",padding:\"10px\",marginBottom:\"10px\",cursor:\"pointer\"},children:\"Clear All Active Bookings\"}),/*#__PURE__*/_jsx(\"div\",{children:bookings.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No active bookings\"}):/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Train No.\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Coach No.\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bookings.map((b,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:b.passengerName}),/*#__PURE__*/_jsx(\"td\",{children:b.trainNumber}),/*#__PURE__*/_jsx(\"td\",{children:b.coachNumber})]},index))})]})})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","io","axios","jsx","_jsx","jsxs","_jsxs","socket","App","bookings","setBookings","form","setForm","passengerName","trainNumber","coachNumber","station","minutesBeforeArrival","cooliesNeeded","fetchBookings","on","newBooking","prev","off","res","get","data","handleChange","e","target","name","value","handleSubmit","preventDefault","post","emit","clearBookings","delete","alert","interval","setInterval","now","Date","updatedBookings","filter","b","arrivalTime","createdAt","setMinutes","getMinutes","clearInterval","className","children","onSubmit","type","placeholder","onChange","required","onClick","style","background","color","padding","marginBottom","cursor","length","map","index"],"sources":["A:/A/Project/coolie-booking/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport io from \"socket.io-client\";\nimport axios from \"axios\";\nimport \"./App.css\"; // Ensure you have this CSS file\n\nconst socket = io(\"https://coolie-booking-service.onrender.com\");\n\nconst App = () => {\n  const [bookings, setBookings] = useState([]);\n  const [form, setForm] = useState({\n    passengerName: \"\",\n    trainNumber: \"\",\n    coachNumber: \"\",\n    station: \"\",\n    minutesBeforeArrival: \"\",\n    cooliesNeeded: \"\",\n  });\n\n  useEffect(() => {\n    fetchBookings();\n\n    socket.on(\"updateBookings\", (newBooking) => {\n      setBookings((prev) => [...prev, newBooking]);\n    });\n\n    return () => socket.off(\"updateBookings\");\n  }, []);\n\n  const fetchBookings = async () => {\n    const res = await axios.get(\"https://coolie-booking-service.onrender.com/api/bookings\");\n    setBookings(res.data);\n  };\n\n  const handleChange = (e) => {\n    setForm({ ...form, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const res = await axios.post(\"https://coolie-booking-service.onrender.com/api/bookings\", form);\n    socket.emit(\"newBooking\", res.data);\n    setForm({ passengerName: \"\", trainNumber: \"\", coachNumber: \"\", station: \"\", minutesBeforeArrival: \"\", cooliesNeeded: \"\" });\n    fetchBookings();\n  };\n\n  // Clear All Active Bookings Manually\n  const clearBookings = async () => {\n    await axios.delete(\"https://coolie-booking-service.onrender.com/api/bookings/clear\");\n    setBookings([]);\n    alert(\"All active bookings cleared!\");\n  };\n\n  // Auto-delete bookings +10 mins after \"Minutes Before Arrival\"\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const now = new Date();\n      const updatedBookings = bookings.filter((b) => {\n        const arrivalTime = new Date(b.createdAt);\n        arrivalTime.setMinutes(arrivalTime.getMinutes() + b.minutesBeforeArrival + 10);\n        return arrivalTime > now;\n      });\n      setBookings(updatedBookings);\n    }, 60000); // Runs every 60 seconds\n\n    return () => clearInterval(interval);\n  }, [bookings]);\n\n  return (\n    <div className=\"container\">\n      <div className=\"booking-form\">\n        <h1>ðŸš† Coolie Booking Service</h1>\n        <form onSubmit={handleSubmit}>\n          <input type=\"text\" name=\"passengerName\" placeholder=\"Passenger Name\" value={form.passengerName} onChange={handleChange} required />\n          <input type=\"text\" name=\"trainNumber\" placeholder=\"Train Number\" value={form.trainNumber} onChange={handleChange} required />\n          <input type=\"text\" name=\"coachNumber\" placeholder=\"Coach Number\" value={form.coachNumber} onChange={handleChange} required />\n          <input type=\"text\" name=\"station\" placeholder=\"Station Name\" value={form.station} onChange={handleChange} required />\n          <input type=\"number\" name=\"minutesBeforeArrival\" placeholder=\"Minutes Before Arrival\" value={form.minutesBeforeArrival} onChange={handleChange} required />\n          <input type=\"number\" name=\"cooliesNeeded\" placeholder=\"Coolies Needed\" value={form.cooliesNeeded} onChange={handleChange} required />\n          <button type=\"submit\">Book Coolie ðŸš€</button>\n        </form>\n      </div>\n\n      <div className=\"active-bookings\">\n        <h2>ðŸ“‹ Active Bookings:</h2>\n        <button onClick={clearBookings} style={{ background: \"red\", color: \"white\", padding: \"10px\", marginBottom: \"10px\", cursor: \"pointer\" }}>\n          Clear All Active Bookings\n        </button>\n        <div>\n          {bookings.length === 0 ? (\n            <p>No active bookings</p>\n          ) : (\n            <table>\n              <thead>\n                <tr>\n                  <th>Name</th>\n                  <th>Train No.</th>\n                  <th>Coach No.</th>\n                </tr>\n              </thead>\n              <tbody>\n                {bookings.map((b, index) => (\n                  <tr key={index}>\n                    <td>{b.passengerName}</td>\n                    <td>{b.trainNumber}</td>\n                    <td>{b.coachNumber}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}